general:
  branches:
    only:
      - master
    ignore:
      - develop

machine:
  environment:
    APP_KEY: base64:HWAbzPcsTpNhgN1KSLV+cAhylyIBxCXYY6ZLYARlr+0=
  python:
    version: 2.7

dependencies:
  pre:
    - yes | pecl install mongodb
    - echo "extension=mongodb.so" > /opt/circleci/php/$(phpenv global)/etc/php.ini
    - sudo pip install 'awsebcli==3.7.4' --force-reinstall

test:
  override:
    - phpunit

deployment:
  production:
      branch: master
      commands:
        - eb deploy --profile default